<!DOCTYPE html>

<html>

<head>

  <title>Tap Tap Cookie</title>

  <style>

    canvas {

      border: 1px solid black;

    }

    #loginButton {

      background-image: url('login-button.jpg');

      width: 150px;

      height: 50px;

      cursor: pointer;

    }

  </style>

  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-database.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-auth.js"></script>

</head>

<body>

  <div id="loginPage">

    <h1>Login</h1>

    <input type="text" id="usernameInput" placeholder="Username">

    <div id="loginButton" onclick="login()"></div>

  </div>

  <div id="gamePage" style="display: none;">

    <h1>Welcome <span id="username"></span>!</h1>

    <h2>Score: <span id="score">0</span></h2>

    <canvas id="canvas"></canvas>

    <h2>Ping: <span id="ping">-</span> ms</h2>

    <h2>Leaderboard</h2>

    <ol id="leaderboard"></ol>

  </div>

  <script>

    // Firebase Config

    var firebaseConfig = {

      apiKey: "AIzaSyBMUFoehYxHGwdXgDaQFwcYy1PiOQXnSkg",

      authDomain: "tapcookieonline.firebaseapp.com",

      databaseURL: "https://tapcookieonline-default-rtdb.firebaseio.com",

      projectId: "tapcookieonline",

      storageBucket: "tapcookieonline.appspot.com",

      messagingSenderId: "493293620415",

      appId: "1:493293620415:web:a1e97f68243dc3bbcd0a0a"

    };

    // Initialize Firebase

    firebase.initializeApp(firebaseConfig);

    var auth = firebase.auth();

    var database = firebase.database();

    // Get leaderboard reference

    var leaderboardRef = database.ref('leaderboard');

    // Get DOM elements

    var loginPage = document.getElementById('loginPage');

    var gamePage = document.getElementById('gamePage');

    var canvas = document.getElementById('canvas');

    var scoreDisplay = document.getElementById('score');

    var usernameInput = document.getElementById('usernameInput');

    var usernameDisplay = document.getElementById('username');

    var pingDisplay = document.getElementById('ping');

    var leaderboardElement = document.getElementById('leaderboard');

    // Initialize score and click count

    var score = 0;

    var clickCount = 0;

    // Check authentication status when the page is loaded

    firebase.auth().onAuthStateChanged(function(user) {

      if (user) {

        // User is already logged in

        showGamePage(user.displayName);

      } else {

        // User is not logged in

        showLoginPage();

      }

    });

    function login() {

      var username = usernameInput.value;

      if (username.trim() === '') {

        alert('Please enter your username.');

        return;

      }

      // Set username

      usernameDisplay.textContent = username;

      // Show game page and hide login page

      loginPage.style.display = 'none';

      gamePage.style.display = 'block';

      // Update leaderboard data from Firebase and update the view

      leaderboardRef.on('value', function(snapshot) {

        var leaderboard = snapshot.val();

        updateLeaderboard(leaderboard);

      });

      // Start the game

      startGame();

    }

    function startGame() {

      // Implement game logic here

    }

    function updateLeaderboard(leaderboard) {

      // Clear leaderboard

      leaderboardElement.innerHTML = '';

      // Sort leaderboard by score

      var sortedLeaderboard = Object.entries(leaderboard).sort(function(a, b) {

        return b[1].score - a[1].score;

      });

      // Update leaderboard view

      sortedLeaderboard.forEach(function(entry) {

        var username = entry[0];

        var score = entry[1].score;

        var leaderboardItem = document.createElement('li');

        leaderboardItem.textContent = username + ': ' + score;

        leaderboardElement.appendChild(leaderboardItem);

      });

    }

  </script>

</body>

</html>


